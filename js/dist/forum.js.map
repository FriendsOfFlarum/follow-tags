{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@fof/follow-tags/webpack/bootstrap","webpack://@fof/follow-tags/webpack/runtime/compat get default export","webpack://@fof/follow-tags/webpack/runtime/define property getters","webpack://@fof/follow-tags/webpack/runtime/hasOwnProperty shorthand","webpack://@fof/follow-tags/webpack/runtime/make namespace object","webpack://@fof/follow-tags/external root \"flarum.core.compat['forum/app']\"","webpack://@fof/follow-tags/external root \"flarum.core.compat['common/Model']\"","webpack://@fof/follow-tags/./src/forum/addSubscriptionControls.js","webpack://@fof/follow-tags/external root \"flarum.core.compat['common/extend']\"","webpack://@fof/follow-tags/external root \"flarum.core.compat['forum/components/IndexPage']\"","webpack://@fof/follow-tags/external root \"flarum.core.compat['forum/states/DiscussionListState']\"","webpack://@fof/follow-tags/./src/forum/utils/isFollowingPage.ts","webpack://@fof/follow-tags/external root \"flarum.core.compat['common/app']\"","webpack://@fof/follow-tags/./src/common/utils/followingPageOptions.js","webpack://@fof/follow-tags/./src/forum/utils/getDefaultFollowingFiltering.js","webpack://@fof/follow-tags/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@fof/follow-tags/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@fof/follow-tags/external root \"flarum.core.compat['common/Component']\"","webpack://@fof/follow-tags/external root \"flarum.core.compat['common/components/Button']\"","webpack://@fof/follow-tags/external root \"flarum.core.compat['common/components/Dropdown']\"","webpack://@fof/follow-tags/./src/forum/components/FollowingPageFilterDropdown.js","webpack://@fof/follow-tags/./src/forum/addFollowedTagsDiscussions.js","webpack://@fof/follow-tags/external root \"flarum.core.compat['forum/components/Notification']\"","webpack://@fof/follow-tags/./src/forum/components/NewDiscussionNotification.js","webpack://@fof/follow-tags/./src/forum/icons.js","webpack://@fof/follow-tags/./src/forum/components/NewPostNotification.js","webpack://@fof/follow-tags/./src/forum/components/NewDiscussionTagNotification.js","webpack://@fof/follow-tags/external root \"flarum.core.compat['common/models/Discussion']\"","webpack://@fof/follow-tags/external root \"flarum.core.compat['common/components/Badge']\"","webpack://@fof/follow-tags/external root \"flarum.core.compat['forum/components/SettingsPage']\"","webpack://@fof/follow-tags/external root \"flarum.core.compat['common/components/FieldSet']\"","webpack://@fof/follow-tags/external root \"flarum.core.compat['common/components/Select']\"","webpack://@fof/follow-tags/./src/forum/addPreferences.js","webpack://@fof/follow-tags/external root \"flarum.core.compat['forum/components/NotificationGrid']\"","webpack://@fof/follow-tags/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@fof/follow-tags/external root \"flarum.core.compat['common/helpers/textContrastClass']\"","webpack://@fof/follow-tags/external root \"flarum.core.compat['common/utils/classList']\"","webpack://@fof/follow-tags/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@fof/follow-tags/./src/forum/components/FollowingHero.tsx","webpack://@fof/follow-tags/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@fof/follow-tags/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@fof/follow-tags/./src/forum/utils/index.ts","webpack://@fof/follow-tags/./src/forum/utils/subscriptionOptions.ts","webpack://@fof/follow-tags/./src/common/index.ts","webpack://@fof/follow-tags/./src/forum/components/SubscriptionOptionItem.tsx","webpack://@fof/follow-tags/external root \"flarum.core.compat['common/utils/Stream']\"","webpack://@fof/follow-tags/./src/forum/components/SubscriptionModal.tsx","webpack://@fof/follow-tags/external root \"flarum.core.compat['common/components/Tooltip']\"","webpack://@fof/follow-tags/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@fof/follow-tags/./src/forum/components/SubscriptionStateButton.js","webpack://@fof/follow-tags/./src/forum/components/index.ts","webpack://@fof/follow-tags/./src/forum/index.ts","webpack://@fof/follow-tags/./src/forum/extenders/extendIndexPage.tsx","webpack://@fof/follow-tags/./src/forum/addDiscussionBadge.js","webpack://@fof/follow-tags/./src/forum/extendNotificationGrid.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","import app from 'flarum/forum/app';\nimport Model from 'flarum/common/Model';\n\nexport default () => {\n  app.store.models.tags.prototype.subscription = Model.attribute('subscription');\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/IndexPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/states/DiscussionListState'];","import app from 'flarum/forum/app';\n\nexport default () => 'flarum-subscriptions' in flarum.extensions && m.route.get().includes(app.route('following'));\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/app'];","import app from 'flarum/common/app';\n\nlet opts;\n\nexport default (section) =>\n  opts ||\n  (opts = ['none', 'tags'].reduce((o, key) => {\n    o[key] = app.translator.trans(`fof-follow-tags.${section}.following_${key}_label`);\n\n    return o;\n  }, {}));\n","import app from 'flarum/forum/app';\nimport followingPageOptions from '../../common/utils/followingPageOptions';\n\nexport let options;\n\nexport const getOptions = () => {\n  if (!options) {\n    options = followingPageOptions('forum.index.following');\n  }\n\n  return options;\n};\n\nexport const getDefaultFollowingFiltering = () => {\n  getOptions();\n\n  let value = app.data['fof-follow-tags.following_page_default'];\n\n  if (!options[value]) {\n    value = null;\n  }\n\n  if (app.session.user) {\n    const preference = app.session.user.preferences().followTagsPageDefault;\n\n    if (options[preference]) {\n      value = preference;\n    }\n  }\n\n  return value || 'none';\n};\n","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Dropdown'];","import app from 'flarum/forum/app';\nimport Component from 'flarum/common/Component';\n\nimport Button from 'flarum/common/components/Button';\nimport Dropdown from 'flarum/common/components/Dropdown';\n\nimport { getDefaultFollowingFiltering, getOptions } from '../utils/getDefaultFollowingFiltering';\n\nexport default class FollowingPageFilterDropdown extends Component {\n  view() {\n    const selected = app.discussions.followTags;\n    const options = this.options();\n\n    return Dropdown.component(\n      {\n        buttonClassName: 'Button',\n        label: options[selected] || getDefaultFollowingFiltering(),\n      },\n      Object.keys(options).map((key) => {\n        const active = key === selected;\n\n        return Button.component(\n          {\n            active,\n            icon: active ? 'fas fa-check' : true,\n            onclick: () => {\n              app.discussions.followTags = key;\n\n              app.discussions.refresh();\n            },\n          },\n          options[key]\n        );\n      })\n    );\n  }\n\n  options() {\n    return getOptions();\n  }\n}\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\n\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport DiscussionListState from 'flarum/forum/states/DiscussionListState';\n\nimport isFollowingPage from './utils/isFollowingPage';\n\nimport { getDefaultFollowingFiltering } from './utils/getDefaultFollowingFiltering';\nimport FollowingPageFilterDropdown from './components/FollowingPageFilterDropdown';\n\nexport default () => {\n  extend(DiscussionListState.prototype, 'requestParams', function (params) {\n    if (!isFollowingPage() || !app.session.user) return;\n\n    if (!this.followTags) {\n      this.followTags = getDefaultFollowingFiltering();\n    }\n\n    const followTags = this.followTags;\n\n    if (app.current.get('routeName') === 'following' && followTags === 'tags') {\n      params.filter['following-tag'] = true;\n\n      delete params.filter.subscription;\n    }\n  });\n\n  extend(IndexPage.prototype, 'viewItems', function (items) {\n    if (!isFollowingPage() || !app.session.user) {\n      return;\n    }\n\n    items.add('follow-tags', <FollowingPageFilterDropdown />);\n  });\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/Notification'];","import app from 'flarum/forum/app';\nimport Notification from 'flarum/forum/components/Notification';\n\nexport default class NewDiscussionNotification extends Notification {\n  icon() {\n    return 'fas fa-user-tag';\n  }\n\n  href() {\n    const notification = this.attrs.notification;\n    const discussion = notification.subject();\n\n    return app.route.discussion(discussion);\n  }\n\n  content() {\n    return app.translator.trans('fof-follow-tags.forum.notifications.new_discussion_text', {\n      user: this.attrs.notification.fromUser(),\n      title: this.attrs.notification.subject().title(),\n    });\n  }\n\n  excerpt() {\n    return null;\n  }\n}\n","export default {\n  [false]: 'fas fa-star',\n  follow: 'fas fa-star',\n  lurk: 'fas fa-comments',\n  ignore: 'fas fa-bell-slash',\n  hide: 'fas fa-eye-slash',\n};\n","import app from 'flarum/forum/app';\nimport Notification from 'flarum/forum/components/Notification';\n\nimport icons from '../icons';\n\nexport default class NewPostNotification extends Notification {\n  icon() {\n    return icons.lurk;\n  }\n\n  href() {\n    const notification = this.attrs.notification;\n    const discussion = notification.subject();\n    const content = notification.content() || {};\n\n    return app.route.discussion(discussion, content.postNumber);\n  }\n\n  content() {\n    return app.translator.trans('fof-follow-tags.forum.notifications.new_post_text', { user: this.attrs.notification.fromUser() });\n  }\n\n  excerpt() {\n    return null;\n  }\n}\n","import app from 'flarum/forum/app';\nimport Notification from 'flarum/forum/components/Notification';\n\nexport default class NewDiscussionTagNotification extends Notification {\n  icon() {\n    return 'fas fa-user-tag';\n  }\n\n  href() {\n    const notification = this.attrs.notification;\n    const discussion = notification.subject();\n\n    return app.route.discussion(discussion);\n  }\n\n  content() {\n    return app.translator.trans('fof-follow-tags.forum.notifications.new_discussion_tag_text', {\n      user: this.attrs.notification.fromUser(),\n      title: this.attrs.notification.subject().title(),\n    });\n  }\n\n  excerpt() {\n    return null;\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Discussion'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Badge'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/SettingsPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/FieldSet'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Select'];","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\n\nimport SettingsPage from 'flarum/forum/components/SettingsPage';\nimport FieldSet from 'flarum/common/components/FieldSet';\nimport Select from 'flarum/common/components/Select';\n\nimport { getOptions, getDefaultFollowingFiltering } from './utils/getDefaultFollowingFiltering';\n\nexport default () => {\n  extend(SettingsPage.prototype, 'settingsItems', function (items) {\n    items.add(\n      'fof-follow-tags',\n      FieldSet.component(\n        {\n          label: app.translator.trans('fof-follow-tags.forum.user.settings.heading'),\n          className: 'Settings-follow-tags',\n        },\n        [\n          <div className=\"Form-group\">\n            <p>{app.translator.trans('fof-follow-tags.forum.user.settings.filter_label')}</p>\n            {Select.component({\n              options: getOptions(),\n              value: this.user.preferences().followTagsPageDefault || getDefaultFollowingFiltering(),\n              onchange: (value) => {\n                this.user.savePreferences({ followTagsPageDefault: value }).then(() => {\n                  m.redraw();\n                });\n              },\n            })}\n          </div>,\n        ]\n      )\n    );\n  });\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/NotificationGrid'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/icon'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/textContrastClass'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/classList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","import app from 'flarum/forum/app';\nimport Component from 'flarum/common/Component';\nimport icon from 'flarum/common/helpers/icon';\nimport textContrastClass from 'flarum/common/helpers/textContrastClass';\nimport classList from 'flarum/common/utils/classList';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport type Mithril from 'mithril';\n\nexport default class FollowingHero extends Component {\n  view() {\n    const color = this.heroColor();\n\n    return (\n      <header\n        className={classList('Hero', 'FollowingHero', { 'FollowingHero--colored': color, [textContrastClass(color)]: color })}\n        style={color ? { '--hero-bg': color } : undefined}\n      >\n        <div className=\"container\">{this.viewItems().toArray()}</div>\n      </header>\n    );\n  }\n\n  viewItems(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    items.add('content', <div className=\"containerNarrow\">{this.contentItems().toArray()}</div>, 80);\n\n    return items;\n  }\n\n  contentItems(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    items.add(\n      'following-title',\n      <h1 className=\"Hero-title\">\n        {icon(this.heroIcon())} {app.translator.trans('fof-follow-tags.forum.hero.title')}\n      </h1>,\n      100\n    );\n\n    return items;\n  }\n\n  heroColor(): string | null {\n    // Example return a color string to display a colored hero\n    //return app.forum.attribute<string>('themeSecondaryColor');\n    return null;\n  }\n\n  heroIcon(): string {\n    return 'fas fa-star';\n  }\n}\n","export default function _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","import { options, getOptions, getDefaultFollowingFiltering } from './getDefaultFollowingFiltering';\nimport isFollowingPage from './isFollowingPage';\nimport subscriptionOptions from './subscriptionOptions';\nimport { utils as commonUtils } from '../../common';\n\nexport const utils = {\n  options,\n  getOptions,\n  getDefaultFollowingFiltering,\n  isFollowingPage,\n  subscriptionOptions,\n  ...commonUtils,\n};\n","type SubscriptionOption = {\n  subscription: string;\n  icon: string;\n  labelKey: string;\n  descriptionKey: string;\n};\n\nconst subscriptionOptions: SubscriptionOption[] = [\n  {\n    subscription: 'not_follow',\n    icon: 'far fa-star',\n    labelKey: 'fof-follow-tags.forum.sub_controls.not_following_button',\n    descriptionKey: 'fof-follow-tags.forum.sub_controls.not_following_text',\n  },\n  {\n    subscription: 'follow',\n    icon: 'fas fa-star',\n    labelKey: 'fof-follow-tags.forum.sub_controls.following_button',\n    descriptionKey: 'fof-follow-tags.forum.sub_controls.following_text',\n  },\n  {\n    subscription: 'lurk',\n    icon: 'fas fa-eye',\n    labelKey: 'fof-follow-tags.forum.sub_controls.lurking_button',\n    descriptionKey: 'fof-follow-tags.forum.sub_controls.lurking_text',\n  },\n  {\n    subscription: 'ignore',\n    icon: 'fas fa-bell-slash',\n    labelKey: 'fof-follow-tags.forum.sub_controls.ignoring_button',\n    descriptionKey: 'fof-follow-tags.forum.sub_controls.ignoring_text',\n  },\n  {\n    subscription: 'hide',\n    icon: 'fas fa-eye-slash',\n    labelKey: 'fof-follow-tags.forum.sub_controls.hiding_button',\n    descriptionKey: 'fof-follow-tags.forum.sub_controls.hiding_text',\n  },\n];\n\nexport default subscriptionOptions;\n","import followingPageOptions from './utils/followingPageOptions';\n\nexport const utils = {\n  followingPageOptions,\n};\n","import app from 'flarum/forum/app';\nimport icon from 'flarum/common/helpers/icon';\nimport Component, { ComponentAttrs } from 'flarum/common/Component';\n\ninterface SubscriptionOptionItemAttrs extends ComponentAttrs {\n  active: boolean;\n  icon: string;\n  labelKey: string;\n  descriptionKey: string;\n  onclick: () => void;\n}\n\nexport default class SubscriptionOptionItem extends Component<SubscriptionOptionItemAttrs> {\n  view() {\n    const isSelected = this.attrs.active;\n\n    return (\n      <div className={`SubscriptionOption ${isSelected ? 'selected' : ''}`} onclick={this.attrs.onclick}>\n        {icon(this.attrs.icon, { className: 'SubscriptionOption-icon' })}\n        <span className=\"SubscriptionOption-title\">{app.translator.trans(this.attrs.labelKey)}</span>\n        <div className=\"SubscriptionOption-description\">{app.translator.trans(this.attrs.descriptionKey)}</div>\n        {isSelected && icon('fas fa-check', { className: 'SubscriptionOption-selectedIcon' })}\n      </div>\n    );\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/Stream'];","import app from 'flarum/forum/app';\nimport Modal, { IInternalModalAttrs } from 'flarum/common/components/Modal';\nimport Button from 'flarum/common/components/Button';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport { utils } from '../utils';\nimport SubscriptionOptionItem from './SubscriptionOptionItem';\nimport type Mithril from 'mithril';\nimport Tag from 'flarum/tags/models/Tag';\nimport Stream from 'flarum/common/utils/Stream';\nimport Tooltip from 'flarum/common/components/Tooltip';\n\ninterface ISubscriptionModalAttrs extends IInternalModalAttrs {\n  model?: Tag;\n}\n\nexport default class SubscriptionModal extends Modal<ISubscriptionModalAttrs> {\n  subscription!: string;\n  loading: Stream<boolean>;\n  canShowTooltip: boolean | undefined = undefined;\n\n  oninit(vnode: Mithril.Vnode<ISubscriptionModalAttrs, this>): void {\n    super.oninit(vnode);\n    this.loading = Stream(false);\n    this.subscription = this.attrs.model.subscription() || 'not_follow';\n\n    const preferences = app.session.user?.preferences();\n    const notifyEmail = preferences['notify_newPostInTag_email'];\n    const notifyAlert = preferences['notify_newPostInTag_alert'];\n\n    if ((notifyEmail || notifyAlert) && this.subscription === 'not_follow') {\n      this.canShowTooltip = true;\n    } else {\n      this.canShowTooltip = false;\n    }\n  }\n\n  className() {\n    return 'SubscriptionModal Modal--medium';\n  }\n\n  title() {\n    return app.translator.trans('fof-follow-tags.forum.sub_controls.header', {\n      tagName: this.attrs.model.name(),\n    });\n  }\n\n  content() {\n    const preferences = app.session.user?.preferences();\n    const notifyEmail = preferences['notify_newPostInTag_email'];\n    const notifyAlert = preferences['notify_newPostInTag_alert'];\n\n    return (\n      <div className=\"Modal-body\">\n        {this.formOptionItems().toArray()}\n        <div className=\"Form-group\">\n          <Button className=\"Button Button--primary\" onclick={() => this.saveSubscription(this.subscription)} loading={this.loading()}>\n            {app.translator.trans('fof-follow-tags.forum.sub_controls.submit_button')}\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  formOptionItems(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    items.add(\n      'subscription_type',\n      <div className=\"Form-group\">\n        <label>{app.translator.trans('fof-follow-tags.forum.sub_controls.subscription_label', { tagName: this.attrs.model.name() })}</label>\n        {this.subscriptionOptionItems().toArray()}\n      </div>,\n      60\n    );\n\n    return items;\n  }\n\n  subscriptionOptionItems(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n    let priority = 100;\n\n    utils.subscriptionOptions.forEach((option, index) => {\n      const attrs = {\n        ...option,\n        onclick: () => {\n          this.subscription = option.subscription;\n          this.canShowTooltip = false;\n        },\n        active: this.subscription === option.subscription,\n        disabled: option.subscription === 'hide' && this.attrs.model.isHidden(),\n      };\n\n      items.add(`subscription-option-${index}`, <SubscriptionOptionItem {...attrs} />, priority);\n      priority -= 5;\n    });\n\n    return items;\n  }\n\n  saveSubscription(subscription: string) {\n    const tag = this.attrs.model;\n\n    this.loading(true);\n\n    this.subscription = subscription;\n\n    app\n      .request({\n        url: `${app.forum.attribute('apiUrl')}/tags/${tag.id()}/subscription`,\n        method: 'POST',\n        body: {\n          data: this.requestData(),\n        },\n      })\n      .then((res: any) => app.store.pushPayload(res))\n      .then(() => {\n        this.loading(false);\n\n        m.redraw();\n        this.hide();\n      });\n  }\n\n  requestData(): { [key: string]: string } {\n    return { subscription: this.subscription };\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Tooltip'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","import app from 'flarum/forum/app';\nimport Button from 'flarum/common/components/Button';\nimport { utils } from '../utils';\nimport Tooltip from 'flarum/common/components/Tooltip';\nimport extractText from 'flarum/common/utils/extractText';\nimport Stream from 'flarum/common/utils/Stream';\n\nexport default class SubscriptionStateButton extends Button {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.loading = Stream(false);\n    this.canShowTooltip = Stream(false);\n  }\n\n  onbeforeupdate(vnode) {\n    super.onbeforeupdate(vnode);\n\n    const subscription = this.attrs.subscription || false;\n\n    const preferences = app.session.user.preferences();\n    const notifyEmail = preferences['notify_newPostInTag_email'];\n    const notifyAlert = preferences['notify_newPostInTag_alert'];\n\n    if ((notifyEmail || notifyAlert) && subscription === false) {\n      this.canShowTooltip(undefined);\n    } else {\n      this.canShowTooltip(false);\n    }\n  }\n\n  view(vnode) {\n    const subscription = this.attrs.subscription || false;\n    let option = utils.subscriptionOptions.find((opt) => opt.subscription === subscription);\n\n    let buttonIcon = option ? option.icon : 'fas fa-star';\n    let buttonLabel = option ? app.translator.trans(option.labelKey) : app.translator.trans('fof-follow-tags.forum.sub_controls.follow_button');\n\n    this.attrs.className = (this.attrs.className || '') + ' SubscriptionButton ' + 'SubscriptionButton--' + subscription;\n    this.attrs.icon = buttonIcon;\n\n    const preferences = app.session.user.preferences();\n    const notifyEmail = preferences['notify_newPostInTag_email'];\n\n    const tooltipText = extractText(\n      app.translator.trans(\n        notifyEmail ? 'fof-follow-tags.forum.sub_controls.notify_email_tooltip' : 'fof-follow-tags.forum.sub_controls.notify_alert_tooltip'\n      )\n    );\n\n    return (\n      <Tooltip\n        text={\n          // By adding this constraint we make sure that when we explicitly set the\n          // value of `canShowTooltip` to `false`, the internal `shouldRecreateTooltip`\n          // property of the `Tooltip` component is set to `true` and we can, in that\n          // way, switch between 'manual' and 'hover' trigger modes for the tooltip.\n          typeof this.canShowTooltip() === 'boolean' ? '' : tooltipText\n        }\n        tooltipVisible={this.canShowTooltip()}\n        position=\"bottom\"\n        delay={250}\n      >\n        {super.view(Object.assign({}, vnode, { children: buttonLabel }))}\n      </Tooltip>\n    );\n  }\n}\n","import FollowingHero from './FollowingHero';\nimport FollowingPageFilterDropdown from './FollowingPageFilterDropdown';\nimport NewDiscussionNotification from './NewDiscussionNotification';\nimport NewDiscussionTagNotification from './NewDiscussionTagNotification';\nimport NewPostNotification from './NewPostNotification';\nimport SubscriptionModal from './SubscriptionModal';\nimport SubscriptionOptionItem from './SubscriptionOptionItem';\nimport SubscriptionStateButton from './SubscriptionStateButton';\n\nexport const components = {\n  FollowingPageFilterDropdown,\n  NewDiscussionNotification,\n  NewDiscussionTagNotification,\n  NewPostNotification,\n  SubscriptionModal,\n  SubscriptionOptionItem,\n  SubscriptionStateButton,\n  FollowingHero,\n};\n","import app from 'flarum/forum/app';\nimport addSubscriptionControls from './addSubscriptionControls';\nimport addFollowedTagsDiscussions from './addFollowedTagsDiscussions';\nimport NewDiscussionNotification from './components/NewDiscussionNotification';\nimport NewPostNotification from './components/NewPostNotification';\nimport NewDiscussionTagNotification from './components/NewDiscussionTagNotification';\nimport addDiscussionBadge from './addDiscussionBadge';\nimport addPreferences from './addPreferences';\nimport extendNotificationGrid from './extendNotificationGrid';\nimport extendIndexPage from './extenders/extendIndexPage';\n\nexport * from './components';\nexport * from './utils';\n\napp.initializers.add(\n  'fof/follow-tags',\n  () => {\n    if (!app.initializers.has('flarum-tags')) {\n      console.error('[fof/follow-tags] flarum/tags is not enabled');\n      return;\n    }\n\n    addSubscriptionControls();\n    extendIndexPage();\n\n    if ('flarum-subscriptions' in flarum.extensions) {\n      addDiscussionBadge();\n      addFollowedTagsDiscussions();\n      addPreferences();\n    }\n\n    app.notificationComponents.newPostInTag = NewPostNotification;\n    app.notificationComponents.newDiscussionInTag = NewDiscussionNotification;\n    app.notificationComponents.newDiscussionTag = NewDiscussionTagNotification;\n\n    extendNotificationGrid();\n  },\n  -1\n);\n","import app from 'flarum/forum/app';\nimport { extend, override } from 'flarum/common/extend';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport FollowingHero from '../components/FollowingHero';\nimport SubscriptionModal from '../components/SubscriptionModal';\nimport SubscriptionStateButton from '../components/SubscriptionStateButton';\n\nexport default function extendIndexPage() {\n  extend(IndexPage.prototype, 'sidebarItems', function (items) {\n    if (!this.currentTag() || !app.session.user) return;\n\n    const tag = this.currentTag();\n    if (!tag) return;\n\n    if (items.has('newDiscussion')) items.setPriority('newDiscussion', 10);\n\n    items.add(\n      'subscriptionButton',\n      <SubscriptionStateButton\n        className=\"Button App-primaryControl\"\n        /** @ts-expect-error */\n        subscription={tag.subscription()}\n        onclick={() => app.modal.show(SubscriptionModal, { model: tag })}\n      />,\n      5\n    );\n  });\n\n  override(IndexPage.prototype, 'hero', function (original: any) {\n    if (app.current.get('routeName') === 'following') {\n      return <FollowingHero />;\n    }\n\n    return original();\n  });\n}\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport Discussion from 'flarum/common/models/Discussion';\nimport Badge from 'flarum/common/components/Badge';\n\nimport isFollowingPage from './utils/isFollowingPage';\n\nexport default function addSubscriptionBadge() {\n  extend(Discussion.prototype, 'badges', function (badges) {\n    if (!isFollowingPage() || !this.tags()) {\n      return;\n    }\n\n    const subscriptions = this.tags()\n      .map((tag) => tag.subscription())\n      .filter((state) => ['lurk', 'follow'].includes(state));\n\n    const type = subscriptions.includes('lurk') ? 'lurking' : 'following';\n\n    if (subscriptions.length) {\n      badges.add(\n        'followTags',\n        Badge.component({\n          label: app.translator.trans(`fof-follow-tags.forum.badge.${type}_tag_tooltip`),\n          icon: 'fas fa-user-tag',\n          type: `${type}-tag`,\n        })\n      );\n    }\n  });\n}\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport NotificationGrid from 'flarum/forum/components/NotificationGrid';\n\nexport default function extendNotificationGrid() {\n  extend(NotificationGrid.prototype, 'notificationTypes', function (items) {\n    items.add('newDiscussionInTag', {\n      name: 'newDiscussionInTag',\n      icon: 'fas fa-user-tag',\n      label: app.translator.trans('fof-follow-tags.forum.settings.notify_new_discussion_label'),\n    });\n\n    items.add('newPostInTag', {\n      name: 'newPostInTag',\n      icon: 'fas fa-user-tag',\n      label: app.translator.trans('fof-follow-tags.forum.settings.notify_new_post_label'),\n    });\n\n    items.add('newDiscussionTag', {\n      name: 'newDiscussionTag',\n      icon: 'fas fa-user-tag',\n      label: app.translator.trans('fof-follow-tags.forum.settings.notify_new_discussion_tag_label'),\n    });\n  });\n}\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","extensions","m","route","includes","app","opts","section","reduce","trans","options","getOptions","followingPageOptions","getDefaultFollowingFiltering","user","preference","preferences","followTagsPageDefault","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","_inheritsLoose","subClass","superClass","create","constructor","FollowingPageFilterDropdown","view","selected","followTags","this","Dropdown","buttonClassName","label","keys","map","active","Button","icon","onclick","refresh","Component","NewDiscussionNotification","href","discussion","attrs","notification","subject","content","fromUser","title","excerpt","Notification","follow","lurk","ignore","hide","NewPostNotification","icons","postNumber","NewDiscussionTagNotification","FollowingHero","color","heroColor","className","classList","textContrastClass","style","undefined","viewItems","toArray","items","ItemList","add","contentItems","heroIcon","_extends","assign","target","i","arguments","length","source","apply","utils","isFollowingPage","subscriptionOptions","subscription","labelKey","descriptionKey","SubscriptionOptionItem","isSelected","SubscriptionModal","loading","canShowTooltip","oninit","vnode","Stream","model","notifyEmail","notifyAlert","tagName","name","formOptionItems","saveSubscription","subscriptionOptionItems","priority","forEach","option","index","disabled","isHidden","tag","url","attribute","id","method","body","data","requestData","then","res","pushPayload","redraw","Modal","SubscriptionStateButton","onbeforeupdate","find","opt","buttonIcon","buttonLabel","tooltipText","extractText","text","tooltipVisible","position","delay","children","components","has","models","tags","Model","extend","IndexPage","currentTag","setPriority","show","override","original","Discussion","badges","subscriptions","filter","state","type","Badge","DiscussionListState","params","SettingsPage","FieldSet","Select","onchange","savePreferences","newPostInTag","newDiscussionInTag","newDiscussionTag","NotificationGrid","console","error"],"sourceRoot":""}